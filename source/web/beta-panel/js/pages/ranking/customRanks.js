$(run=function(){socket.getDBValue('ranks_module_toggle','modules','./systems/ranksSystem.js',function(e){if(!helpers.getModuleStatus('ranksCustomModule',e.modules)){return}
socket.getDBTableValues('custom_get_ranks','viewerRanks',function(results){let tableData=[];for(let i=0;i<results.length;i++){tableData.push([results[i].key,results[i].value,$('<div/>',{'class':'btn-group'}).append($('<button/>',{'type':'button','class':'btn btn-xs btn-danger','style':'float: right','data-user':results[i].key,'html':$('<i/>',{'class':'fa fa-trash'})})).append($('<button/>',{'type':'button','class':'btn btn-xs btn-warning','style':'float: right','data-user':results[i].key,'html':$('<i/>',{'class':'fa fa-edit'})})).html()])}
if($.fn.DataTable.isDataTable('#ranksCustomTable')){$('#ranksCustomTable').DataTable().destroy();$('#ranksCustomTable').off()}
let table=$('#ranksCustomTable').DataTable({'searching':!0,'autoWidth':!1,'lengthChange':!1,'data':tableData,'columnDefs':[{'className':'default-table','orderable':!1,'targets':2},{'width':'45%','targets':0}],'columns':[{'title':'Username'},{'title':'Rank'},{'title':'Actions'}]});table.on('click','.btn-danger',function(){let user=$(this).data('user'),row=$(this).parents('tr');socket.removeDBValue('rm_custom_rank','viewerRanks',user,function(){table.row(row).remove().draw(!1);toastr.success('Successfully removed the rank from the user!')})});table.on('click','.btn-warning',function(){let user=$(this).data('user'),t=$(this);socket.getDBValue('rank_get_name','viewerRanks',user,function(e){helpers.getModal('edit-set-rank','Edit User Rank','Save',$('<form/>',{'role':'form'}).append(helpers.getInputGroup('rank-user','text','Username','',user,'Name of the user for the rank to be set on.')).append(helpers.getInputGroup('rank-name','text','Rank','',e.viewerRanks,'Rank name to give to the user')),function(){let rankUser=$('#rank-user'),rankName=$('#rank-name');switch(!1){case helpers.handleInputString(rankUser):case helpers.handleInputString(rankName):break;default:socket.removeDBValue('del_rank_custom','viewerRanks',user,function(){socket.updateDBValue('edit_rank_custom','viewerRanks',rankUser.val().toLowerCase(),rankName.val(),function(){t.parents('tr').find('td:eq(0)').text(rankUser.val().toLowerCase());t.parents('tr').find('td:eq(1)').text(rankName.val());$('#edit-set-rank').modal('hide');toastr.success('Successfully edited the user rank!')})})}}).modal('toggle')})})})})});$(function(){$('#ranksCustomModuleToggle').on('change',function(){socket.sendCommandSync('ranks_module_toggle_cmd','module '+($(this).is(':checked')?'enablesilent':'disablesilent')+' ./systems/ranksSystem.js',run)});$('#rank-user-button').on('click',function(){helpers.getModal('set-rank','Set User Rank','Save',$('<form/>',{'role':'form'}).append(helpers.getInputGroup('rank-user','text','Username','PhantomBot','','Name of the user for the rank to be set on.')).append(helpers.getInputGroup('rank-name','text','Rank','Bot','','Rank name to give to the user.')),function(){let rankUser=$('#rank-user'),rankName=$('#rank-name');switch(!1){case helpers.handleInputString(rankUser):case helpers.handleInputString(rankName):break;default:socket.updateDBValue('set_rank_custom','viewerRanks',rankUser.val().toLowerCase(),rankName.val(),function(){run();$('#set-rank').modal('hide');toastr.success('Successfully added the rank to the user!')})}}).modal('toggle')});$('#rank-settings-button').on('click',function(){socket.getDBValues('get_custom_rank_settings',{tables:['settings','settings'],keys:['rankEligableTime','rankEligableCost']},!0,function(e){helpers.getModal('settings-rank','Rank Settings','Save',$('<form/>',{'role':'form'}).append(helpers.getInputGroup('rank-cost','number','Rank Cost','',e.rankEligableCost,'How much a custom rank will cost for a user.')).append(helpers.getInputGroup('rank-time','number','Rank Hours','',e.rankEligableTime,'How many hours a user needs before they can buy a custom rank.')),function(){let rankCost=$('#rank-cost'),rankTime=$('#rank-time');switch(!1){case helpers.handleInputNumber(rankCost):case helpers.handleInputNumber(rankTime):break;default:socket.updateDBValues('update_custom_rank_Settings',{tables:['settings','settings'],keys:['rankEligableTime','rankEligableCost'],values:[rankTime.val(),rankCost.val()]},function(){$('#settings-rank').modal('hide');toastr.success('Successfully updated rank settings')})}}).modal('toggle')})});window.location.hash='#'})