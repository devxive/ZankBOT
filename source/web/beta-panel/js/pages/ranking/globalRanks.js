$(run=function(){socket.getDBValue('ranks_module_toggle','modules','./systems/ranksSystem.js',function(e){if(!helpers.getModuleStatus('ranksModule',e.modules)){return}
socket.getDBTableValues('global_get_ranks','ranksMapping',function(results){let tableData=[];for(let i=0;i<results.length;i++){tableData.push([results[i].key,results[i].value,$('<div/>',{'class':'btn-group'}).append($('<button/>',{'type':'button','class':'btn btn-xs btn-danger','style':'float: right','data-rank':results[i].key,'html':$('<i/>',{'class':'fa fa-trash'})})).append($('<button/>',{'type':'button','class':'btn btn-xs btn-warning','style':'float: right','data-rank':results[i].key,'html':$('<i/>',{'class':'fa fa-edit'})})).html()])}
if($.fn.DataTable.isDataTable('#ranksTable')){$('#ranksTable').DataTable().destroy();$('#ranksTable').off()}
let table=$('#ranksTable').DataTable({'searching':!0,'autoWidth':!1,'lengthChange':!1,'data':tableData,'columnDefs':[{'className':'default-table','orderable':!1,'targets':2},{'width':'45%','targets':0}],'columns':[{'title':'Hours'},{'title':'Rank'},{'title':'Actions'}]});table.on('click','.btn-danger',function(){let rank=$(this).data('rank'),row=$(this).parents('tr');socket.removeDBValue('rm_global_rank','ranksMapping',rank,function(){socket.sendCommand('rm_global_rank_cmd','rankreloadtable',function(){table.row(row).remove().draw(!1);toastr.success('Successfully removed the rank!')})})});table.on('click','.btn-warning',function(){let rank=$(this).data('rank'),t=$(this);socket.getDBValue('rank_get_name','ranksMapping',rank,function(e){helpers.getModal('edit-rank','Edit Rank','Save',$('<form/>',{'role':'form'}).append(helpers.getInputGroup('rank-name','text','Rank','',e.ranksMapping,'Name of the rank.')).append(helpers.getInputGroup('rank-hours','number','Hours','',rank,'Number of hours before a user gets this rank.')),function(){let rankName=$('#rank-name'),rankHours=$('#rank-hours');switch(!1){case helpers.handleInputString(rankName):case helpers.handleInputNumber(rankHours):break;default:socket.removeDBValue('rm_rank_edit_global','ranksMapping',rank,function(){socket.updateDBValue('edit_rank_global','ranksMapping',rankHours.val(),rankName.val(),function(){socket.sendCommand('edit_global_rank_cmd','rankreloadtable',function(){t.parents('tr').find('td:eq(0)').text(rankHours.val());t.parents('tr').find('td:eq(1)').text(rankName.val());t.data('rank',rankHours.val());$('#edit-rank').modal('hide');toastr.success('Successfully edited the rank!')})})})}}).modal('toggle')})})})})});$(function(){$('#ranksModuleToggle').on('change',function(){socket.sendCommand('ranks_module_toggle_cmd','module '+($(this).is(':checked')?'enablesilent':'disablesilent')+' ./systems/ranksSystem.js',run)});$('#add-rank-button').on('click',function(){helpers.getModal('add-rank','Add Rank','Save',$('<form/>',{'role':'form'}).append(helpers.getInputGroup('rank-name','text','Rank','Vip','','Name of the rank.')).append(helpers.getInputGroup('rank-hours','number','Hours','5','','Number of hours before a user gets this rank.')),function(){let rankName=$('#rank-name'),rankHours=$('#rank-hours');switch(!1){case helpers.handleInputString(rankName):case helpers.handleInputNumber(rankHours):break;default:socket.updateDBValue('add_rank_global','ranksMapping',rankHours.val(),rankName.val(),function(){socket.sendCommand('add_global_rank_cmd','rankreloadtable',function(){run();$('#add-rank').modal('hide');toastr.success('Successfully added the rank!')})})}}).modal('toggle')});window.location.hash='#'})