$(run=function(){socket.getDBValue('quotes_module_toggle','modules','./systems/quoteSystem.js',function(e){if(!helpers.getModuleStatus('quotesModule',e.modules)){return}
socket.getDBTableValues('get_all_quotes','quotes',function(results){let tableData=[];for(let i=0;i<results.length;i++){let data=JSON.parse(results[i].value);tableData.push([i,new Date(parseInt(data[2])).toLocaleDateString(),data[0],data[3],data[1],$('<div/>',{'class':'btn-group'}).append($('<button/>',{'type':'button','class':'btn btn-xs btn-danger','style':'float: right','data-quote':results[i].key,'html':$('<i/>',{'class':'fa fa-trash'})})).append($('<button/>',{'type':'button','class':'btn btn-xs btn-warning','style':'float: right','data-quote':results[i].key,'html':$('<i/>',{'class':'fa fa-edit'})})).html()])}
if($.fn.DataTable.isDataTable('#quotesTable')){$('#quotesTable').DataTable().destroy();$('#quotesTable').off()}
let table=$('#quotesTable').DataTable({'searching':!0,'autoWidth':!1,'lengthChange':!1,'data':tableData,'columnDefs':[{'className':'default-table','orderable':!1,'targets':5},{'width':'5%','targets':0},{'width':'10%','targets':1},{'width':'45%','targets':4}],'columns':[{'title':'Id'},{'title':'Created On'},{'title':'Username'},{'title':'Game'},{'title':'Quote'},{'title':'Action'}]});table.on('click','.btn-danger',function(){let quote=$(this).data('quote');socket.sendCommandSync('rm_quote_cmd','delquotesilent '+quote,function(){run();toastr.success('Successfully removed the quote!')})});table.on('click','.btn-warning',function(){let quote=$(this).data('quote'),t=$(this);socket.getDBValue('edit_quote_get','quotes',quote,function(e){let data=JSON.parse(e.quotes);helpers.getModal('edit-quote','Edit Quote','Save',$('<form/>',{'role':'form'}).append(helpers.getInputGroup('quote-date','text','Created On','',new Date(data[2]).toLocaleDateString(),'Date the quote was created on.')).append(helpers.getInputGroup('quote-user','text','Created By','',data[0],'The user who created the quote.')).append(helpers.getInputGroup('quote-game','text','Game','',data[3],'Game being played when the quote was created.')).append(helpers.getTextAreaGroup('quote-quote','text','Quote','',data[1],'Quote text.',!1)),function(){let quoteDate=$('#quote-date'),quoteUser=$('#quote-user'),quoteGame=$('#quote-game'),quoteQuote=$('#quote-quote');switch(!1){case helpers.handleInputDate(quoteDate):case helpers.handleInputString(quoteUser):case helpers.handleInputString(quoteGame):case helpers.handleInputString(quoteQuote):break;default:socket.updateDBValue('edit_quote_update','quotes',quote,JSON.stringify([quoteUser.val(),quoteQuote.val(),helpers.getEpochFromDate(quoteDate.val()),quoteGame.val()]),function(){t.parents('tr').find('td:eq(1)').text(quoteDate.val());t.parents('tr').find('td:eq(2)').text(quoteUser.val());t.parents('tr').find('td:eq(3)').text(quoteGame.val());t.parents('tr').find('td:eq(4)').text(quoteQuote.val());$('#edit-quote').modal('hide');toastr.success('Successfully edited the quote!')})}}).modal('toggle')})})})})});$(function(){$('#quotesModuleToggle').on('change',function(){socket.sendCommand('quotes_module_toggle_cmd','module '+($(this).is(':checked')?'enablesilent':'disablesilent')+' ./systems/quoteSystem.js',run)});$('#add-quote-button').on('click',function(){helpers.getModal('add-quote','Add Quote','Save',$('<form/>',{'role':'form'}).append(helpers.getTextAreaGroup('quote-quote','text','Quote','PhantomBot is great!','','Quote text.',!1)),function(){let quoteQuote=$('#quote-quote');switch(!1){case helpers.handleInputString(quoteQuote):break;default:socket.sendCommandSync('add_quote_cmd','addquotesilent '+quoteQuote.val(),function(){run();$('#add-quote').modal('hide');toastr.success('Successfully added quote!')})}}).modal('toggle')});$('#quote-settings-button').on('click',function(){socket.getDBValue('get_quote_settings','settings','quoteMessage',function(e){helpers.getModal('quote-settings','Quote Settings','Save',$('<form/>',{'role':'form'}).append(helpers.getInputGroup('quote-msg','text','Quote Response','',helpers.getDefaultIfNullOrUndefined(e.settings,'[(id)] "(quote)", by (user) ((date))'),'Message said in chat when someone uses the quote command. Tags: (id), (quote), (user), (game) and (date)')),function(){let quoteMsg=$('#quote-msg');switch(!1){case helpers.handleInputString(quoteMsg):break;default:socket.updateDBValue('get_quote_settings_update','settings','quoteMessage',quoteMsg.val(),function(){$('#quote-settings').modal('hide');toastr.success('Successfully saved quote settings!')})}}).modal('toggle')})});window.location.hash='#'})