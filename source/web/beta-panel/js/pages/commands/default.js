$(function(){socket.getDBTableValues('commands_get_all','permcom',function(results){let tableData=[];for(let i=0;i<results.length;i++){tableData.push(['!'+results[i].key,helpers.getGroupNameById(results[i].value),$('<div/>',{'class':'btn-group'}).append($('<button/>',{'type':'button','class':'btn btn-xs btn-danger','style':'float: right','data-toggle':'tooltip','title':'Deletes the command permission and resets it to default on startup. This does not remove the command unless it doesn\'t exist anymore.','data-command':results[i].key,'html':$('<i/>',{'class':'fa fa-trash'})})).append($('<button/>',{'type':'button','class':'btn btn-xs btn-warning','style':'float: right','data-command':results[i].key,'html':$('<i/>',{'class':'fa fa-edit'})})).html()])}
if($.fn.DataTable.isDataTable('#defaultCommandsTable')){$('#defaultCommandsTable').DataTable().destroy();$('#defaultCommandsTable').off()}
let table=$('#defaultCommandsTable').DataTable({'searching':!0,'autoWidth':!1,'data':tableData,'columnDefs':[{'className':'default-table','orderable':!1,'targets':2},{'width':'45%','targets':0}],'columns':[{'title':'Command'},{'title':'User Level'},{'title':'Actions'}]});table.on('click','.btn-danger',function(){let command=$(this).data('command'),row=$(this).parents('tr'),t=$(this);socket.removeDBValue('permcom_temp_del','permcom',command,function(e){t.tooltip('hide');table.row(row).remove().draw(!1);toastr.success('Successfully reset permission on command !'+command)})});table.on('click','.btn-warning',function(){let command=$(this).data('command'),t=$(this);socket.getDBValues('default_command_edit',{tables:['permcom','cooldown','pricecom','paycom'],keys:[command,command,command,command]},function(e){let cooldownJson=(e.cooldown===null?{isGlobal:'true',seconds:0}:JSON.parse(e.cooldown));helpers.getAdvanceModal('edit-command','Edit Command','Save',$('<form/>',{'role':'form'}).append(helpers.getInputGroup('command-name','text','Command','','!'+command,'Name of the command. This cannot be edited.',!0)).append(helpers.getDropdownGroup('command-permission','User Level',helpers.getGroupNameById(e.permcom),['Caster','Administrators','Moderators','Subscribers','Donators','Hosters','Regulars','Viewers'])).append($('<div/>',{'class':'collapse','id':'advance-collapse','html':$('<form/>',{'role':'form'}).append(helpers.getInputGroup('command-cost','number','Cost','0',helpers.getDefaultIfNullOrUndefined(e.pricecom,'0'),'Cost in points that will be taken from the user when running the command.')).append(helpers.getInputGroup('command-reward','number','Reward','0',helpers.getDefaultIfNullOrUndefined(e.paycom,'0'),'Reward in points the user will be given when running the command.')).append(helpers.getInputGroup('command-cooldown','number','Cooldown','5',cooldownJson.seconds,'Cooldown of the command in seconds.').append($('<input/>',{'type':'checkbox','id':'command-cooldown-global','data-toggle':'tooltip','title':'If checked the cooldown will be applied to everyone in the channel. When not checked, the cooldown is applied per-user.','style':'cursor: pointer; margin-top: 5px;'}).prop('checked',cooldownJson.isGlobal==='true')).append(' Global'))})),function(){let commandPermission=$('#command-permission'),commandCost=$('#command-cost'),commandReward=$('#command-reward'),commandCooldown=$('#command-cooldown'),commandCooldownGlobal=$('#command-cooldown-global').is(':checked');switch(!1){case helpers.handleInputNumber(commandCost):case helpers.handleInputNumber(commandReward):case helpers.handleInputNumber(commandCooldown):break;default:socket.updateDBValues('custom_command_edit',{tables:['pricecom','paycom'],keys:[command,command],values:[commandCost.val(),commandReward.val()]},function(){socket.wsEvent('default_command_edit_cooldown_ws','./core/commandCoolDown.js',null,['add',command,commandCooldown.val(),String(commandCooldownGlobal)],function(){socket.sendCommand('default_command_permisison_update','permcomsilent '+command+' '+helpers.getGroupIdByName(commandPermission.find(':selected').text(),!0),function(){t.parents('tr').find('td:eq(1)').text(commandPermission.find(':selected').text());$('#edit-command').modal('hide');toastr.success('Successfully edited command !'+command)})})})}}).modal('toggle')})})});window.location.hash='#'})